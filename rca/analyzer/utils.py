
_OFFSET_REG = {
    16: 'RAX',
    24: 'RCX',
    32: 'RDX',
    40: 'RBX',
    48: 'RSP',
    56: 'RBP',
    64: 'RSI',
    72: 'RDI',
    80: 'R8',
    88: 'R9',
    96: 'R10',
    104: 'R11',
    112: 'R12',
    120: 'R13',
    128: 'R14',
    136: 'R15',
    144: 'CC_OP',
    152: 'CC_DEP1',
    160: 'CC_DEP2',
    168: 'CC_NDEP',
    176: 'D',
    184: 'RIP',
    192: 'AC',
    200: 'ID',
    208: 'FS',
    792: 'CR3',
    1032: 'GS',
}

def offset_to_reg(offset):
    if offset in _OFFSET_REG:
        return _OFFSET_REG[offset].lower()
    else:
        return f'R_{offset}'.lower()

'''
{16: 'rax',
 24: 'rcx',
 32: 'rdx',
 40: 'rbx',
 48: 'rsp',
 56: 'rbp',
 64: 'rsi',
 72: 'rdi',
 80: 'r8',
 88: 'r9',
 96: 'r10',
 104: 'r11',
 112: 'r12',
 120: 'r13',
 128: 'r14',
 136: 'r15',
 144: 'cc_op',
 152: 'cc_dep1',
 160: 'cc_dep2',
 168: 'cc_ndep',
 176: 'd',
 184: 'rip',
 192: 'ac',
 200: 'id',
 208: 'fs',
 216: 'sseround',
 768: 'cr0',
 784: 'cr2',
 792: 'cr3',
 800: 'cr4',
 832: 'cr8',
 224: 'ymm0',
 256: 'ymm1',
 288: 'ymm2',
 320: 'ymm3',
 352: 'ymm4',
 384: 'ymm5',
 416: 'ymm6',
 448: 'ymm7',
 480: 'ymm8',
 512: 'ymm9',
 544: 'ymm10',
 576: 'ymm11',
 608: 'ymm12',
 640: 'ymm13',
 672: 'ymm14',
 704: 'ymm15',
 896: 'ftop',
 904: 'fpreg',
 968: 'fptag',
 976: 'fpround',
 984: 'fc3210',
 992: 'emnote',
 1000: 'cmstart',
 1008: 'cmlen',
 1016: 'nraddr',
 1032: 'gs',
 1040: 'ip_at_syscall'}
'''

_REG_OFFSET = {
    'AH': 16,
    'AL': 16,
    'AX': 16,
    'EAX': 16,
    'RAX': 16,

    'CH': 24,
    'CL': 24,
    'CX': 24,
    'ECX': 24,
    'RCX': 24,

    'DH': 32,
    'DL': 32,
    'DX': 32,
    'EDX': 32,
    'RDX': 32,

    'BH': 40,
    'BL': 40,
    'BX': 40,
    'EBX': 40,
    'RBX': 40,

    'SPL': 48,
    'SP': 48,
    'ESP': 48,
    'RSP': 48,
    
    'BPL': 56,
    'BP': 56,
    'EBP': 56,
    'RBP': 56,

    'SIL': 64,
    'SI': 64,
    'RSI': 64,
    'ESI': 64,

    'DIL': 72,
    'DI': 72,
    'EDI': 72,
    'RDI': 72,

    'R8B': 80,
    'R8W': 80,
    'R8D': 80,
    'R8': 80,

    'R9B': 88,
    'R9W': 88,
    'R9D': 88,
    'R9': 88,

    'R10B': 96,
    'R10W': 96,
    'R10D': 96,
    'R10': 96,

    'R11B': 104,
    'R11W': 104,
    'R11D': 104,
    'R11': 104,

    'R12B': 112,
    'R12W': 112,
    'R12D': 112,
    'R12': 112,

    'R13B': 120,
    'R13W': 120,
    'R13D': 120,
    'R13': 120,

    'R14B': 128,
    'R14W': 128,
    'R14D': 128,
    'R14': 128,

    'R15B': 136,
    'R15W': 136,
    'R15D': 136,
    'R15': 136,

    'CC_OP': 144,
    'CC_DEP1': 152,
    'CC_DEP2': 160,
    'CC_NDEP': 168,
    'RIP': 184,
    'R_184': 184,
    'R_192': 192,
    'R_200': 200,
    'R_208': 208,

    'R_792': 792,
    'CR3': 792,

    'GS': 1032,
}

def reg_to_offset(reg):
    return _REG_OFFSET[reg]

_VEX_REG_OFFSET = {
    'RAX': 16, 
    'RCX': 24, 
    'RDX': 32, 
    'RBX': 40, 
    'RSP': 48, 
    'RBP': 56, 
    'RSI': 64, 
    'RDI': 72, 
    'R8': 80, 
    'R9': 88, 
    'R10': 96, 
    'R11': 104, 
    'R12': 112, 
    'R13': 120, 
    'R14': 128, 
    'R15': 136,
    'RIP': 184, 
}

def reg_to_vex(reg):
    return _VEX_REG_OFFSET[reg.upper()]
